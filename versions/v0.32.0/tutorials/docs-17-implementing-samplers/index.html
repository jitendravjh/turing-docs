<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../versions.html" rel="next">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Library API</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">For Developers (Inference)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Documentation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Modelling Syntax and Interface</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-14-using-turing-quick-start/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick Start</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-09-using-turing-advanced/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Usage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Using Turing - Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Turing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">For Developers (PPL)</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">For Developers (Inference)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../versions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Versions</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/TuringTutorials/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/TuringTutorials/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Documentation</li><li class="breadcrumb-item"><a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html">For Developers (Inference)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-29.19800150297776</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-29.19800150297776</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([0.0, 0.0, 0.0]), MALAState{Vector{Float64}}([0.0, 0.0, 0.0]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -3.14195   -4.79475   -5.27519   …  -5.48878   -4.53804   -5.77063
 -0.711133  -0.278335  -0.315353     -0.401753   0.335857   0.657323
  2.16563    3.78445    4.47351       5.04147    5.36999    5.31518</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.99991     1.00654
  0.00674667  1.00476
  5.00523     1.00129</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip670">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip670)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip671">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip670)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip672">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip670)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1672.9 2640.76,1672.9 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1428.04 2640.76,1428.04 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1183.17 2640.76,1183.17 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,938.313 2640.76,938.313 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,693.451 2640.76,693.451 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,448.589 2640.76,448.589 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,203.727 2640.76,203.727 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1672.9 215.714,1672.9 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1428.04 215.714,1428.04 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1183.17 215.714,1183.17 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,938.313 215.714,938.313 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,693.451 215.714,693.451 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,448.589 215.714,448.589 "></polyline>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,203.727 215.714,203.727 "></polyline>
<path clip-path="url(#clip670)" d="M50.5475 1673.35 L80.2233 1673.35 L80.2233 1677.29 L50.5475 1677.29 L50.5475 1673.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M89.1352 1655.62 L111.357 1655.62 L111.357 1657.61 L98.8111 1690.18 L93.9269 1690.18 L105.732 1659.55 L89.1352 1659.55 L89.1352 1655.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M120.478 1684.3 L125.362 1684.3 L125.362 1690.18 L120.478 1690.18 L120.478 1684.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M135.593 1655.62 L153.95 1655.62 L153.95 1659.55 L139.876 1659.55 L139.876 1668.03 Q140.894 1667.68 141.913 1667.52 Q142.931 1667.33 143.95 1667.33 Q149.737 1667.33 153.116 1670.5 Q156.496 1673.67 156.496 1679.09 Q156.496 1684.67 153.024 1687.77 Q149.552 1690.85 143.232 1690.85 Q141.056 1690.85 138.788 1690.48 Q136.542 1690.11 134.135 1689.37 L134.135 1684.67 Q136.218 1685.8 138.441 1686.36 Q140.663 1686.91 143.14 1686.91 Q147.144 1686.91 149.482 1684.81 Q151.82 1682.7 151.82 1679.09 Q151.82 1675.48 149.482 1673.37 Q147.144 1671.27 143.14 1671.27 Q141.265 1671.27 139.39 1671.68 Q137.538 1672.1 135.593 1672.98 L135.593 1655.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M49.5521 1428.49 L79.2279 1428.49 L79.2279 1432.42 L49.5521 1432.42 L49.5521 1428.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M89.3667 1410.76 L107.723 1410.76 L107.723 1414.69 L93.6491 1414.69 L93.6491 1423.16 Q94.6676 1422.82 95.6861 1422.65 Q96.7047 1422.47 97.7232 1422.47 Q103.51 1422.47 106.89 1425.64 Q110.269 1428.81 110.269 1434.23 Q110.269 1439.81 106.797 1442.91 Q103.325 1445.99 97.0056 1445.99 Q94.8297 1445.99 92.5612 1445.62 Q90.3158 1445.25 87.9084 1444.51 L87.9084 1439.81 Q89.9917 1440.94 92.2139 1441.5 Q94.4361 1442.05 96.913 1442.05 Q100.918 1442.05 103.256 1439.95 Q105.593 1437.84 105.593 1434.23 Q105.593 1430.62 103.256 1428.51 Q100.918 1426.4 96.913 1426.4 Q95.038 1426.4 93.163 1426.82 Q91.3112 1427.24 89.3667 1428.12 L89.3667 1410.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M119.482 1439.44 L124.367 1439.44 L124.367 1445.32 L119.482 1445.32 L119.482 1439.44 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M144.552 1413.84 Q140.941 1413.84 139.112 1417.4 Q137.306 1420.94 137.306 1428.07 Q137.306 1435.18 139.112 1438.74 Q140.941 1442.28 144.552 1442.28 Q148.186 1442.28 149.991 1438.74 Q151.82 1435.18 151.82 1428.07 Q151.82 1420.94 149.991 1417.4 Q148.186 1413.84 144.552 1413.84 M144.552 1410.13 Q150.362 1410.13 153.417 1414.74 Q156.496 1419.32 156.496 1428.07 Q156.496 1436.8 153.417 1441.4 Q150.362 1445.99 144.552 1445.99 Q138.741 1445.99 135.663 1441.4 Q132.607 1436.8 132.607 1428.07 Q132.607 1419.32 135.663 1414.74 Q138.741 1410.13 144.552 1410.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M50.5475 1183.63 L80.2233 1183.63 L80.2233 1187.56 L50.5475 1187.56 L50.5475 1183.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M94.3436 1196.52 L110.663 1196.52 L110.663 1200.45 L88.7186 1200.45 L88.7186 1196.52 Q91.3806 1193.77 95.9639 1189.14 Q100.57 1184.48 101.751 1183.14 Q103.996 1180.62 104.876 1178.88 Q105.779 1177.12 105.779 1175.43 Q105.779 1172.68 103.834 1170.94 Q101.913 1169.2 98.8111 1169.2 Q96.6121 1169.2 94.1584 1169.97 Q91.7278 1170.73 88.9501 1172.28 L88.9501 1167.56 Q91.7741 1166.43 94.2278 1165.85 Q96.6815 1165.27 98.7185 1165.27 Q104.089 1165.27 107.283 1167.95 Q110.478 1170.64 110.478 1175.13 Q110.478 1177.26 109.668 1179.18 Q108.881 1181.08 106.774 1183.67 Q106.195 1184.34 103.094 1187.56 Q99.9917 1190.76 94.3436 1196.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M120.478 1194.58 L125.362 1194.58 L125.362 1200.45 L120.478 1200.45 L120.478 1194.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M135.593 1165.89 L153.95 1165.89 L153.95 1169.83 L139.876 1169.83 L139.876 1178.3 Q140.894 1177.95 141.913 1177.79 Q142.931 1177.61 143.95 1177.61 Q149.737 1177.61 153.116 1180.78 Q156.496 1183.95 156.496 1189.37 Q156.496 1194.95 153.024 1198.05 Q149.552 1201.13 143.232 1201.13 Q141.056 1201.13 138.788 1200.76 Q136.542 1200.39 134.135 1199.64 L134.135 1194.95 Q136.218 1196.08 138.441 1196.64 Q140.663 1197.19 143.14 1197.19 Q147.144 1197.19 149.482 1195.08 Q151.82 1192.98 151.82 1189.37 Q151.82 1185.76 149.482 1183.65 Q147.144 1181.54 143.14 1181.54 Q141.265 1181.54 139.39 1181.96 Q137.538 1182.38 135.593 1183.26 L135.593 1165.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M99.3204 924.112 Q95.7093 924.112 93.8806 927.676 Q92.075 931.218 92.075 938.348 Q92.075 945.454 93.8806 949.019 Q95.7093 952.56 99.3204 952.56 Q102.955 952.56 104.76 949.019 Q106.589 945.454 106.589 938.348 Q106.589 931.218 104.76 927.676 Q102.955 924.112 99.3204 924.112 M99.3204 920.408 Q105.131 920.408 108.186 925.014 Q111.265 929.598 111.265 938.348 Q111.265 947.074 108.186 951.681 Q105.131 956.264 99.3204 956.264 Q93.5102 956.264 90.4315 951.681 Q87.376 947.074 87.376 938.348 Q87.376 929.598 90.4315 925.014 Q93.5102 920.408 99.3204 920.408 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M119.482 949.713 L124.367 949.713 L124.367 955.593 L119.482 955.593 L119.482 949.713 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M144.552 924.112 Q140.941 924.112 139.112 927.676 Q137.306 931.218 137.306 938.348 Q137.306 945.454 139.112 949.019 Q140.941 952.56 144.552 952.56 Q148.186 952.56 149.991 949.019 Q151.82 945.454 151.82 938.348 Q151.82 931.218 149.991 927.676 Q148.186 924.112 144.552 924.112 M144.552 920.408 Q150.362 920.408 153.417 925.014 Q156.496 929.598 156.496 938.348 Q156.496 947.074 153.417 951.681 Q150.362 956.264 144.552 956.264 Q138.741 956.264 135.663 951.681 Q132.607 947.074 132.607 938.348 Q132.607 929.598 135.663 925.014 Q138.741 920.408 144.552 920.408 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M94.3436 706.796 L110.663 706.796 L110.663 710.731 L88.7186 710.731 L88.7186 706.796 Q91.3806 704.041 95.9639 699.411 Q100.57 694.759 101.751 693.416 Q103.996 690.893 104.876 689.157 Q105.779 687.398 105.779 685.708 Q105.779 682.953 103.834 681.217 Q101.913 679.481 98.8111 679.481 Q96.6121 679.481 94.1584 680.245 Q91.7278 681.009 88.9501 682.56 L88.9501 677.837 Q91.7741 676.703 94.2278 676.125 Q96.6815 675.546 98.7185 675.546 Q104.089 675.546 107.283 678.231 Q110.478 680.916 110.478 685.407 Q110.478 687.536 109.668 689.458 Q108.881 691.356 106.774 693.949 Q106.195 694.62 103.094 697.837 Q99.9917 701.032 94.3436 706.796 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M120.478 704.851 L125.362 704.851 L125.362 710.731 L120.478 710.731 L120.478 704.851 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M135.593 676.171 L153.95 676.171 L153.95 680.106 L139.876 680.106 L139.876 688.578 Q140.894 688.231 141.913 688.069 Q142.931 687.884 143.95 687.884 Q149.737 687.884 153.116 691.055 Q156.496 694.226 156.496 699.643 Q156.496 705.222 153.024 708.323 Q149.552 711.402 143.232 711.402 Q141.056 711.402 138.788 711.032 Q136.542 710.661 134.135 709.921 L134.135 705.222 Q136.218 706.356 138.441 706.911 Q140.663 707.467 143.14 707.467 Q147.144 707.467 149.482 705.36 Q151.82 703.254 151.82 699.643 Q151.82 696.032 149.482 693.925 Q147.144 691.819 143.14 691.819 Q141.265 691.819 139.39 692.236 Q137.538 692.652 135.593 693.532 L135.593 676.171 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M89.3667 431.309 L107.723 431.309 L107.723 435.244 L93.6491 435.244 L93.6491 443.716 Q94.6676 443.369 95.6861 443.207 Q96.7047 443.022 97.7232 443.022 Q103.51 443.022 106.89 446.193 Q110.269 449.364 110.269 454.781 Q110.269 460.36 106.797 463.461 Q103.325 466.54 97.0056 466.54 Q94.8297 466.54 92.5612 466.17 Q90.3158 465.799 87.9084 465.059 L87.9084 460.36 Q89.9917 461.494 92.2139 462.049 Q94.4361 462.605 96.913 462.605 Q100.918 462.605 103.256 460.498 Q105.593 458.392 105.593 454.781 Q105.593 451.17 103.256 449.063 Q100.918 446.957 96.913 446.957 Q95.038 446.957 93.163 447.374 Q91.3112 447.79 89.3667 448.67 L89.3667 431.309 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M119.482 459.989 L124.367 459.989 L124.367 465.869 L119.482 465.869 L119.482 459.989 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M144.552 434.388 Q140.941 434.388 139.112 437.952 Q137.306 441.494 137.306 448.624 Q137.306 455.73 139.112 459.295 Q140.941 462.836 144.552 462.836 Q148.186 462.836 149.991 459.295 Q151.82 455.73 151.82 448.624 Q151.82 441.494 149.991 437.952 Q148.186 434.388 144.552 434.388 M144.552 430.684 Q150.362 430.684 153.417 435.29 Q156.496 439.874 156.496 448.624 Q156.496 457.35 153.417 461.957 Q150.362 466.54 144.552 466.54 Q138.741 466.54 135.663 461.957 Q132.607 457.35 132.607 448.624 Q132.607 439.874 135.663 435.29 Q138.741 430.684 144.552 430.684 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M89.1352 186.447 L111.357 186.447 L111.357 188.438 L98.8111 221.007 L93.9269 221.007 L105.732 190.382 L89.1352 190.382 L89.1352 186.447 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M120.478 215.127 L125.362 215.127 L125.362 221.007 L120.478 221.007 L120.478 215.127 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip670)" d="M135.593 186.447 L153.95 186.447 L153.95 190.382 L139.876 190.382 L139.876 198.854 Q140.894 198.507 141.913 198.345 Q142.931 198.16 143.95 198.16 Q149.737 198.16 153.116 201.331 Q156.496 204.502 156.496 209.919 Q156.496 215.498 153.024 218.599 Q149.552 221.678 143.232 221.678 Q141.056 221.678 138.788 221.308 Q136.542 220.937 134.135 220.197 L134.135 215.498 Q136.218 216.632 138.441 217.187 Q140.663 217.743 143.14 217.743 Q147.144 217.743 149.482 215.636 Q151.82 213.53 151.82 209.919 Q151.82 206.308 149.482 204.201 Q147.144 202.095 143.14 202.095 Q141.265 202.095 139.39 202.512 Q137.538 202.928 135.593 203.808 L135.593 186.447 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip672)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1246.05 268.292,1272.05 270.6,1496.61 272.908,1643.58 275.216,1451.65 277.524,1385.99 279.832,1507.04 282.139,1418.14 284.447,1500.44 286.755,1455.25 289.063,1434.56 291.371,1405.29 293.679,1465.03 295.987,1431.42 298.295,1489.05 300.603,1587.75 302.911,1576.26 305.219,1371.1 307.527,1498.94 309.834,1202.57 312.142,1378.2 314.45,1406.68 316.758,1284.26 319.066,1523.95 321.374,1400.66 323.682,1412.11 325.99,1452.14 328.298,1521.97 330.606,1377.86 332.914,1591.39 335.221,1399.79 337.529,1518.33 339.837,1442.78 342.145,1445.92 344.453,1340.06 346.761,1534.77 349.069,1445.3 351.377,1247.78 353.685,1517.43 355.993,1305.68 358.301,1520.34 360.608,1412.44 362.916,1393.57 365.224,1412.88 367.532,1371.08 369.84,1223.39 372.148,1555.06 374.456,1648.48 376.764,1365.21 379.072,1536.63 381.38,1658.31 383.688,1309.33 385.996,1572.97 388.303,1374.48 390.611,1375.96 392.919,1314.18 395.227,1416.73 397.535,1257.14 399.843,1429.11 402.151,1424.8 404.459,1523.61 406.767,1288.68 409.075,1237.47 411.383,1464.64 413.69,1259.88 415.998,1406.34 418.306,1285.68 420.614,1414.77 422.922,1436.41 425.23,1378.14 427.538,1544.29 429.846,1392.28 432.154,1573.54 434.462,1281.61 436.77,1462.19 439.077,1450.28 441.385,1513.68 443.693,1524.39 446.001,1530.56 448.309,1278.62 450.617,1404.54 452.925,1464.25 455.233,1470.73 457.541,1420.67 459.849,1308.8 462.157,1406.77 464.465,1417.37 466.772,1418.29 469.08,1553.8 471.388,1401.81 473.696,1490.63 476.004,1386.75 478.312,1310.93 480.62,1463.04 482.928,1414.8 485.236,1364.78 487.544,1340.78 489.852,1333.68 492.159,1412.22 494.467,1316.91 496.775,1412.1 499.083,1527.84 501.391,1469.87 503.699,1457.51 506.007,1543.9 508.315,1407.05 510.623,1449.66 512.931,1385.46 515.239,1548.37 517.546,1262.76 519.854,1501.45 522.162,1132.81 524.47,1342.61 526.778,1386.45 529.086,1370.1 531.394,1452.49 533.702,1275.18 536.01,1400.19 538.318,1604.48 540.626,1476.56 542.933,1291.78 545.241,1614.51 547.549,1469.73 549.857,1235.81 552.165,1360.31 554.473,1445.63 556.781,1400.7 559.089,1491.08 561.397,1505.96 563.705,1421.91 566.013,1644.93 568.321,1376.76 570.628,1366.27 572.936,1455.45 575.244,1533.96 577.552,1441.98 579.86,1334.37 582.168,1475.4 584.476,1436.88 586.784,1545.26 589.092,1456.91 591.4,1358.96 593.708,1518.14 596.015,1351.99 598.323,1515.05 600.631,1388.3 602.939,1319.75 605.247,1349.68 607.555,1347.35 609.863,1505.15 612.171,1505.64 614.479,1225.08 616.787,1485.69 619.095,1500.39 621.402,1546.83 623.71,1472.92 626.018,1475.65 628.326,1429.48 630.634,1363.03 632.942,1355.91 635.25,1430.65 637.558,1408.76 639.866,1484.58 642.174,1243.37 644.482,1412.96 646.79,1448.48 649.097,1209.47 651.405,1452.97 653.713,1378.28 656.021,1564.16 658.329,1431.51 660.637,1430.71 662.945,1462.5 665.253,1322.01 667.561,1286.45 669.869,1422.25 672.177,1500.73 674.484,1467 676.792,1500.25 679.1,1465.35 681.408,1483.07 683.716,1291.51 686.024,1487.72 688.332,1406.67 690.64,1441.74 692.948,1502.89 695.256,1383.84 697.564,1444.39 699.871,1265.32 702.179,1325.72 704.487,1522.45 706.795,1298.87 709.103,1407.87 711.411,1494.78 713.719,1539.07 716.027,1527.19 718.335,1356.63 720.643,1370.23 722.951,1495.07 725.259,1460.52 727.566,1317.64 729.874,1461.64 732.182,1454.52 734.49,1479.74 736.798,1416.63 739.106,1418.44 741.414,1382.37 743.722,1359.74 746.03,1588.24 748.338,1380.86 750.646,1353.66 752.953,1364.83 755.261,1436.9 757.569,1478.87 759.877,1415 762.185,1308.92 764.493,1395.97 766.801,1500.74 769.109,1540.71 771.417,1552.29 773.725,1443.32 776.033,1614.6 778.34,1462.38 780.648,1350.45 782.956,1422.09 785.264,1597.36 787.572,1490.96 789.88,1295.89 792.188,1476.88 794.496,1561.48 796.804,1620.43 799.112,1438.1 801.42,1397.47 803.728,1421.49 806.035,1443.83 808.343,1267.27 810.651,1279.44 812.959,1345.23 815.267,1349.3 817.575,1568.15 819.883,1627.12 822.191,1619.95 824.499,1387.09 826.807,1344.64 829.115,1487.39 831.422,1390.36 833.73,1408 836.038,1506.5 838.346,1571.36 840.654,1435.19 842.962,1431.46 845.27,1457.85 847.578,1566.21 849.886,1463.34 852.194,1367.46 854.502,1494.74 856.809,1468.04 859.117,1322.44 861.425,1377.08 863.733,1431.61 866.041,1446 868.349,1316.51 870.657,1445.51 872.965,1316.73 875.273,1324.43 877.581,1436.41 879.889,1353.42 882.197,1493.55 884.504,1517.98 886.812,1279.48 889.12,1393.34 891.428,1517.1 893.736,1394.62 896.044,1370.94 898.352,1463.42 900.66,1602.81 902.968,1377.1 905.276,1314.23 907.584,1449.54 909.891,1342.46 912.199,1446.2 914.507,1435.98 916.815,1392.13 919.123,1427.14 921.431,1343.95 923.739,1337.58 926.047,1625.49 928.355,1497.8 930.663,1505.32 932.971,1251.2 935.278,1478.79 937.586,1367.97 939.894,1395.64 942.202,1590.03 944.51,1505.58 946.818,1433.37 949.126,1634.61 951.434,1234.23 953.742,1665.28 956.05,1498.89 958.358,1509.06 960.665,1524.87 962.973,1419.05 965.281,1445.92 967.589,1364.88 969.897,1610.61 972.205,1250.68 974.513,1389 976.821,1416.96 979.129,1383.65 981.437,1384.48 983.745,1421.91 986.053,1491.49 988.36,1452.51 990.668,1380.05 992.976,1306.58 995.284,1531.65 997.592,1364.52 999.9,1390.18 1002.21,1323.16 1004.52,1576.2 1006.82,1428.35 1009.13,1426.05 1011.44,1333.59 1013.75,1593.29 1016.06,1411.16 1018.36,1558.88 1020.67,1492.79 1022.98,1373.38 1025.29,1388.38 1027.59,1323.61 1029.9,1537.78 1032.21,1514.27 1034.52,1432.24 1036.83,1528.58 1039.13,1437.63 1041.44,1447.8 1043.75,1499.85 1046.06,1439.93 1048.37,1436.7 1050.67,1540.31 1052.98,1367.38 1055.29,1477.86 1057.6,1454.11 1059.91,1507.14 1062.21,1498.47 1064.52,1278.75 1066.83,1428.81 1069.14,1517.6 1071.45,1512.11 1073.75,1349.85 1076.06,1570.28 1078.37,1564.29 1080.68,1348.86 1082.98,1393.33 1085.29,1418.6 1087.6,1549.15 1089.91,1576.35 1092.22,1611.91 1094.52,1432.93 1096.83,1470.75 1099.14,1386.09 1101.45,1274.27 1103.76,1426.74 1106.06,1322.89 1108.37,1504.7 1110.68,1428.89 1112.99,1454.93 1115.3,1508.32 1117.6,1401.32 1119.91,1328.46 1122.22,1630.79 1124.53,1476.35 1126.84,1391.38 1129.14,1490.74 1131.45,1431.6 1133.76,1353.1 1136.07,1501.2 1138.37,1487.83 1140.68,1660.83 1142.99,1495.9 1145.3,1158.31 1147.61,1587.22 1149.91,1541.33 1152.22,1458.47 1154.53,1595.62 1156.84,1201.31 1159.15,1216.47 1161.45,1345.16 1163.76,1333.44 1166.07,1575.9 1168.38,1481.14 1170.69,1557.58 1172.99,1491.66 1175.3,1497.92 1177.61,1462.37 1179.92,1471.93 1182.23,1475.25 1184.53,1564.52 1186.84,1619.08 1189.15,1616.96 1191.46,1489.54 1193.76,1400.89 1196.07,1589.95 1198.38,1362.57 1200.69,1319.59 1203,1445.1 1205.3,1535.74 1207.61,1300.77 1209.92,1295.19 1212.23,1293.27 1214.54,1389.16 1216.84,1284.41 1219.15,1389.62 1221.46,1473.72 1223.77,1291.16 1226.08,1455.74 1228.38,1257.98 1230.69,1512.6 1233,1629.61 1235.31,1388.34 1237.61,1418.25 1239.92,1475.2 1242.23,1514.93 1244.54,1466.19 1246.85,1430.32 1249.15,1249.13 1251.46,1509.04 1253.77,1280.39 1256.08,1374.98 1258.39,1263.14 1260.69,1442.59 1263,1427.38 1265.31,1453.08 1267.62,1445.64 1269.93,1432.24 1272.23,1461.61 1274.54,1536.87 1276.85,1491.71 1279.16,1256.52 1281.47,1349.62 1283.77,1591.73 1286.08,1505.68 1288.39,1359.86 1290.7,1182.49 1293,1314.24 1295.31,1491.16 1297.62,1278.55 1299.93,1519.21 1302.24,1461.23 1304.54,1429.67 1306.85,1427.15 1309.16,1534.65 1311.47,1295.58 1313.78,1406.28 1316.08,1332.82 1318.39,1496.88 1320.7,1472.79 1323.01,1347.07 1325.32,1430.31 1327.62,1315.14 1329.93,1445.17 1332.24,1338.94 1334.55,1662.53 1336.86,1325.72 1339.16,1323.57 1341.47,1565.18 1343.78,1598.26 1346.09,1495.59 1348.39,1545.67 1350.7,1566 1353.01,1522.41 1355.32,1433.04 1357.63,1502.71 1359.93,1222.66 1362.24,1457.84 1364.55,1434.63 1366.86,1556.31 1369.17,1448.13 1371.47,1401.28 1373.78,1371.54 1376.09,1350.04 1378.4,1378.11 1380.71,1512.41 1383.01,1374.71 1385.32,1404.45 1387.63,1419.75 1389.94,1315.42 1392.24,1612.14 1394.55,1317.84 1396.86,1413.36 1399.17,1345.93 1401.48,1714.07 1403.78,1413.91 1406.09,1363.49 1408.4,1522.08 1410.71,1455.68 1413.02,1271.68 1415.32,1423.84 1417.63,1242.51 1419.94,1408.2 1422.25,1472.62 1424.56,1362.58 1426.86,1547.23 1429.17,1517.61 1431.48,1455.13 1433.79,1447.75 1436.1,1441.21 1438.4,1576.68 1440.71,1536.78 1443.02,1367.95 1445.33,1353.3 1447.63,1271.15 1449.94,1391.15 1452.25,1459.08 1454.56,1282.87 1456.87,1471.71 1459.17,1369.76 1461.48,1606.16 1463.79,1329.91 1466.1,1439.97 1468.41,1439.19 1470.71,1604.77 1473.02,1348.48 1475.33,1459.28 1477.64,1468.36 1479.95,1453.66 1482.25,1512.62 1484.56,1399.52 1486.87,1514.5 1489.18,1433.49 1491.49,1428.01 1493.79,1463.95 1496.1,1426.38 1498.41,1254.05 1500.72,1287.4 1503.02,1365.75 1505.33,1617.72 1507.64,1516.01 1509.95,1512.92 1512.26,1422.56 1514.56,1470.19 1516.87,1567.81 1519.18,1335.65 1521.49,1352.47 1523.8,1633.2 1526.1,1321.82 1528.41,1330.35 1530.72,1500.34 1533.03,1356.6 1535.34,1206.66 1537.64,1500.84 1539.95,1403.67 1542.26,1462.84 1544.57,1498.75 1546.88,1284.06 1549.18,1423.6 1551.49,1275.26 1553.8,1656.57 1556.11,1320.16 1558.41,1529.12 1560.72,1418.48 1563.03,1414.56 1565.34,1478.97 1567.65,1438.54 1569.95,1482.31 1572.26,1401.77 1574.57,1497.21 1576.88,1556.19 1579.19,1362.71 1581.49,1304.16 1583.8,1320.62 1586.11,1392.49 1588.42,1452.34 1590.73,1437.25 1593.03,1641.15 1595.34,1483.05 1597.65,1425.48 1599.96,1470.58 1602.26,1352.23 1604.57,1569.04 1606.88,1751.15 1609.19,1402.44 1611.5,1284.34 1613.8,1438.04 1616.11,1351.88 1618.42,1495.46 1620.73,1475.06 1623.04,1358.88 1625.34,1438.66 1627.65,1521.7 1629.96,1459.44 1632.27,1487.93 1634.58,1641.96 1636.88,1480.4 1639.19,1390.99 1641.5,1448.95 1643.81,1330.92 1646.12,1440.8 1648.42,1491.27 1650.73,1259.8 1653.04,1486.8 1655.35,1309.72 1657.65,1448.15 1659.96,1302.31 1662.27,1263.66 1664.58,1502.11 1666.89,1446.51 1669.19,1416.85 1671.5,1515.89 1673.81,1348.95 1676.12,1448.71 1678.43,1308.36 1680.73,1429.7 1683.04,1389.67 1685.35,1240.77 1687.66,1532.57 1689.97,1372.97 1692.27,1450.68 1694.58,1505.48 1696.89,1484.39 1699.2,1392.38 1701.51,1430.46 1703.81,1562.22 1706.12,1589 1708.43,1278.11 1710.74,1338.99 1713.04,1306.55 1715.35,1370.59 1717.66,1519.95 1719.97,1595.39 1722.28,1480.84 1724.58,1410.53 1726.89,1417.55 1729.2,1423.16 1731.51,1453.7 1733.82,1344.33 1736.12,1321.89 1738.43,1377.37 1740.74,1375.09 1743.05,1557.86 1745.36,1352.03 1747.66,1449.36 1749.97,1377.26 1752.28,1482.28 1754.59,1430.92 1756.9,1571.73 1759.2,1536.14 1761.51,1653.15 1763.82,1331.81 1766.13,1376.47 1768.43,1306.83 1770.74,1356.07 1773.05,1539 1775.36,1569.28 1777.67,1585.76 1779.97,1373.05 1782.28,1452.18 1784.59,1398.92 1786.9,1502.45 1789.21,1332.35 1791.51,1372.76 1793.82,1546.09 1796.13,1360.26 1798.44,1381.84 1800.75,1651.32 1803.05,1445.33 1805.36,1298.29 1807.67,1455.31 1809.98,1264.41 1812.28,1297.87 1814.59,1270.51 1816.9,1359.65 1819.21,1424.9 1821.52,1437.52 1823.82,1491.29 1826.13,1624.19 1828.44,1433.97 1830.75,1531.73 1833.06,1520.99 1835.36,1144.49 1837.67,1368.98 1839.98,1298.46 1842.29,1400.13 1844.6,1524.45 1846.9,1454.6 1849.21,1577.93 1851.52,1458.07 1853.83,1412.59 1856.14,1607.35 1858.44,1336.37 1860.75,1405.97 1863.06,1503.37 1865.37,1301.1 1867.67,1427.51 1869.98,1330.38 1872.29,1522.01 1874.6,1247.67 1876.91,1599.26 1879.21,1537.59 1881.52,1201.15 1883.83,1395.09 1886.14,1444.04 1888.45,1387.93 1890.75,1495.21 1893.06,1404.16 1895.37,1395.77 1897.68,1386.6 1899.99,1489.87 1902.29,1541.76 1904.6,1395.64 1906.91,1434.85 1909.22,1537.3 1911.53,1176.39 1913.83,1608.06 1916.14,1277.83 1918.45,1382.02 1920.76,1391.83 1923.06,1318.25 1925.37,1591.37 1927.68,1419.53 1929.99,1346.1 1932.3,1452.35 1934.6,1561.68 1936.91,1572.04 1939.22,1511.01 1941.53,1356.41 1943.84,1332.31 1946.14,1300.22 1948.45,1351.42 1950.76,1334.99 1953.07,1538.24 1955.38,1369.63 1957.68,1606.42 1959.99,1485.1 1962.3,1302.55 1964.61,1412.75 1966.91,1336.55 1969.22,1560.2 1971.53,1387.76 1973.84,1663.82 1976.15,1328.85 1978.45,1390.53 1980.76,1247.64 1983.07,1325.88 1985.38,1286.78 1987.69,1463.85 1989.99,1146.44 1992.3,1291.18 1994.61,1472.48 1996.92,1568.37 1999.23,1369.67 2001.53,1533.99 2003.84,1434.62 2006.15,1464.85 2008.46,1423.75 2010.77,1581.8 2013.07,1425.92 2015.38,1391.02 2017.69,1458.54 2020,1281.32 2022.3,1417 2024.61,1361.29 2026.92,1487.89 2029.23,1385.58 2031.54,1449.88 2033.84,1349.32 2036.15,1498.21 2038.46,1553.62 2040.77,1447.3 2043.08,1440.33 2045.38,1314.72 2047.69,1442.58 2050,1313.18 2052.31,1412.12 2054.62,1454.57 2056.92,1487.31 2059.23,1304.42 2061.54,1511.57 2063.85,1506.23 2066.16,1395.98 2068.46,1336.85 2070.77,1409.93 2073.08,1523.29 2075.39,1340.27 2077.69,1438.23 2080,1519.62 2082.31,1386.35 2084.62,1414.16 2086.93,1479.02 2089.23,1376.31 2091.54,1386.36 2093.85,1358.96 2096.16,1401.21 2098.47,1551.57 2100.77,1451.97 2103.08,1277.3 2105.39,1510.04 2107.7,1328.59 2110.01,1478.51 2112.31,1495.86 2114.62,1432.85 2116.93,1454.79 2119.24,1373.8 2121.55,1461.94 2123.85,1349.16 2126.16,1571.13 2128.47,1385.33 2130.78,1427.17 2133.08,1412.52 2135.39,1590.8 2137.7,1419.83 2140.01,1422.94 2142.32,1369 2144.62,1656.8 2146.93,1510.15 2149.24,1515.49 2151.55,1473.83 2153.86,1416.46 2156.16,1559.36 2158.47,1475.64 2160.78,1205.78 2163.09,1368.53 2165.4,1501.95 2167.7,1489.67 2170.01,1272.17 2172.32,1557.61 2174.63,1471.05 2176.93,1441.05 2179.24,1519.88 2181.55,1213.25 2183.86,1400.07 2186.17,1415.35 2188.47,1299.49 2190.78,1427.21 2193.09,1463.95 2195.4,1464 2197.71,1375.88 2200.01,1397.75 2202.32,1491.73 2204.63,1316 2206.94,1505.1 2209.25,1349.87 2211.55,1470.75 2213.86,1245.17 2216.17,1387.14 2218.48,1393.96 2220.79,1498.77 2223.09,1454 2225.4,1535.18 2227.71,1450.8 2230.02,1445.43 2232.32,1311.38 2234.63,1499.01 2236.94,1483.49 2239.25,1502.59 2241.56,1470.98 2243.86,1363.04 2246.17,1590.17 2248.48,1320.94 2250.79,1493.11 2253.1,1394.97 2255.4,1340.69 2257.71,1422.14 2260.02,1390.22 2262.33,1429.3 2264.64,1537.29 2266.94,1451.83 2269.25,1454.3 2271.56,1392.12 2273.87,1399.86 2276.18,1279.91 2278.48,1442.1 2280.79,1494.49 2283.1,1431.96 2285.41,1382.73 2287.71,1360.24 2290.02,1327.07 2292.33,1339.68 2294.64,1478.27 2296.95,1324.17 2299.25,1486.7 2301.56,1519.52 2303.87,1437.02 2306.18,1481.44 2308.49,1542.65 2310.79,1423.86 2313.1,1535.29 2315.41,1624.69 2317.72,1331.61 2320.03,1477.76 2322.33,1253.77 2324.64,1402.72 2326.95,1574.59 2329.26,1385.89 2331.56,1553.93 2333.87,1356.87 2336.18,1580.86 2338.49,1351.36 2340.8,1462.97 2343.1,1360.86 2345.41,1486.26 2347.72,1442.37 2350.03,1463.27 2352.34,1465.12 2354.64,1460.99 2356.95,1561.49 2359.26,1488.09 2361.57,1298.35 2363.88,1545.91 2366.18,1482.41 2368.49,1452.35 2370.8,1509.97 2373.11,1407.09 2375.42,1227.67 2377.72,1461.98 2380.03,1327.67 2382.34,1392.08 2384.65,1438.6 2386.95,1251 2389.26,1320.76 2391.57,1487.28 2393.88,1492.63 2396.19,1516.96 2398.49,1437.13 2400.8,1434.6 2403.11,1427.8 2405.42,1401.22 2407.73,1428.65 2410.03,1411.88 2412.34,1499.97 2414.65,1390.09 2416.96,1543.3 2419.27,1420.6 2421.57,1447.28 2423.88,1541.18 2426.19,1215.61 2428.5,1726.2 2430.81,1318.72 2433.11,1547.61 2435.42,1425.19 2437.73,1414 2440.04,1248.82 2442.34,1425.34 2444.65,1390.11 2446.96,1471.27 2449.27,1369.22 2451.58,1461.02 2453.88,1394.06 2456.19,1532.47 2458.5,1525.37 2460.81,1273.43 2463.12,1408.63 2465.42,1524.52 2467.73,1376.38 2470.04,1430.21 2472.35,1452.27 2474.66,1204.66 2476.96,1485.79 2479.27,1435.97 2481.58,1692.06 2483.89,1453.79 2486.2,1531.79 2488.5,1670.99 2490.81,1467.06 2493.12,1222.65 2495.43,1313.41 2497.73,1368.82 2500.04,1563.38 2502.35,1310.01 2504.66,1525.65 2506.97,1492.8 2509.27,1454.62 2511.58,1489.21 2513.89,1440.14 2516.2,1309.19 2518.51,1460.68 2520.81,1373.42 2523.12,1431.1 2525.43,1364.53 2527.74,1396.44 2530.05,1391.12 2532.35,1577.8 2534.66,1397.18 2536.97,1510.36 2539.28,1287.54 2541.58,1367.98 2543.89,1513 2546.2,1397.44 2548.51,1374.34 2550.82,1354.02 2553.12,1487.1 2555.43,1445.57 2557.74,1336.21 2560.05,1616.05 2562.36,1302.05 2564.66,1257.73 2566.97,1404.28 2569.28,1501.9 2571.59,1470.21 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1007.96 268.292,939.683 270.6,897.788 272.908,1079.46 275.216,935.45 277.524,801.923 279.832,1063.89 282.139,1016.97 284.447,901.707 286.755,794.111 289.063,799.749 291.371,941.03 293.679,829.216 295.987,1071.06 298.295,931.96 300.603,1010.19 302.911,1027.72 305.219,989.114 307.527,878.04 309.834,1063.58 312.142,829.988 314.45,1036.52 316.758,1076.35 319.066,896.805 321.374,1127.6 323.682,1031.99 325.99,829.212 328.298,942.603 330.606,1049.52 332.914,855.521 335.221,890.71 337.529,871.256 339.837,874.599 342.145,1047.55 344.453,935.811 346.761,971.838 349.069,835.154 351.377,1025.82 353.685,1139.75 355.993,959.79 358.301,1080.31 360.608,1043.01 362.916,884.249 365.224,1010.4 367.532,970.672 369.84,933.577 372.148,1167.04 374.456,837.213 376.764,844.82 379.072,745.207 381.38,769.806 383.688,873.332 385.996,875.059 388.303,963.542 390.611,961.216 392.919,812.986 395.227,714.861 397.535,782.59 399.843,778.602 402.151,895.919 404.459,979.718 406.767,872.948 409.075,837.509 411.383,914.692 413.69,1141.61 415.998,981.065 418.306,944.782 420.614,839.349 422.922,915.755 425.23,926.399 427.538,997.589 429.846,934.104 432.154,1023.85 434.462,1018.1 436.77,983.408 439.077,833.182 441.385,953.779 443.693,974.006 446.001,865.964 448.309,825.532 450.617,863.655 452.925,954.498 455.233,949.653 457.541,953.233 459.849,953.252 462.157,920.924 464.465,1007.48 466.772,1047.51 469.08,1055.82 471.388,1016.06 473.696,959.588 476.004,890.253 478.312,825.638 480.62,875.615 482.928,781.609 485.236,923.502 487.544,967.272 489.852,862.311 492.159,1084.98 494.467,1002.56 496.775,670.716 499.083,872.264 501.391,988.819 503.699,647.436 506.007,757.923 508.315,793.037 510.623,942.005 512.931,1004.05 515.239,1120.86 517.546,999.9 519.854,831.663 522.162,997.682 524.47,1000.75 526.778,818.902 529.086,934.605 531.394,975.203 533.702,872.648 536.01,1026.62 538.318,1058.61 540.626,876.285 542.933,879.571 545.241,905.814 547.549,799.415 549.857,1022.93 552.165,1090.11 554.473,855.903 556.781,1148.75 559.089,946.001 561.397,1042.4 563.705,1207.97 566.013,915.826 568.321,703.107 570.628,874.804 572.936,846.876 575.244,758.917 577.552,1057.33 579.86,965.062 582.168,812.089 584.476,871.842 586.784,726.435 589.092,894.16 591.4,953.299 593.708,1047.11 596.015,913.555 598.323,1062.08 600.631,885.717 602.939,768.774 605.247,947.042 607.555,961.967 609.863,776.947 612.171,798.555 614.479,798.187 616.787,899.818 619.095,992.769 621.402,819.835 623.71,991.301 626.018,974.543 628.326,940.454 630.634,882.469 632.942,961.256 635.25,982.988 637.558,1024.55 639.866,919.951 642.174,1064.55 644.482,871.124 646.79,592.326 649.097,968.868 651.405,971.731 653.713,1041.12 656.021,929.502 658.329,1097.01 660.637,981.319 662.945,860.632 665.253,953.653 667.561,986.243 669.869,973.244 672.177,928.121 674.484,808.271 676.792,837.018 679.1,982.161 681.408,953.701 683.716,827.921 686.024,947.211 688.332,799.103 690.64,1115.76 692.948,864.245 695.256,966.54 697.564,848.908 699.871,977.212 702.179,941.072 704.487,1036.1 706.795,1092.22 709.103,831.855 711.411,895.133 713.719,1009.39 716.027,917.33 718.335,1077.03 720.643,1143.81 722.951,936.678 725.259,1088.97 727.566,967.484 729.874,948.082 732.182,940.602 734.49,1053.04 736.798,874.443 739.106,942.816 741.414,928.351 743.722,1100 746.03,972.491 748.338,848.164 750.646,956.433 752.953,891.969 755.261,883.889 757.569,756.66 759.877,1001.82 762.185,804.218 764.493,912.292 766.801,831.14 769.109,1032.24 771.417,856.797 773.725,1005.07 776.033,1012.42 778.34,1051.47 780.648,1058.29 782.956,798.218 785.264,880.009 787.572,980.752 789.88,916.113 792.188,1050.66 794.496,1063.46 796.804,962.449 799.112,962.081 801.42,820.288 803.728,985.305 806.035,823.798 808.343,877.578 810.651,1040.99 812.959,997.301 815.267,923.422 817.575,933.592 819.883,909.046 822.191,1052.51 824.499,897.162 826.807,1005.26 829.115,1025.24 831.422,963.819 833.73,994.065 836.038,1050.26 838.346,990.755 840.654,1017.17 842.962,1068.01 845.27,1092.24 847.578,842.172 849.886,947.093 852.194,904.895 854.502,862.822 856.809,935.864 859.117,1001.87 861.425,845.885 863.733,929.823 866.041,1017.52 868.349,968.614 870.657,954.054 872.965,958.006 875.273,947.491 877.581,879.474 879.889,882.539 882.197,930.302 884.504,1043.29 886.812,1107.08 889.12,928.288 891.428,957.769 893.736,844.109 896.044,850.318 898.352,829.639 900.66,1133.34 902.968,1019.91 905.276,760.773 907.584,912.176 909.891,794.189 912.199,815.531 914.507,1081.88 916.815,822.465 919.123,1025.01 921.431,936.384 923.739,753.867 926.047,883.533 928.355,945.248 930.663,905.454 932.971,814.938 935.278,945.248 937.586,976.999 939.894,944.508 942.202,1019.37 944.51,1158.17 946.818,965.032 949.126,1073.66 951.434,804.343 953.742,877.648 956.05,902.958 958.358,830.675 960.665,957.59 962.973,936.504 965.281,952.393 967.589,987.489 969.897,1069.44 972.205,1052.68 974.513,739.839 976.821,914.071 979.129,879.872 981.437,1013.56 983.745,973.103 986.053,866.113 988.36,750.677 990.668,801.803 992.976,781.523 995.284,909.306 997.592,877.822 999.9,1042.03 1002.21,1050.44 1004.52,887.493 1006.82,1101.15 1009.13,992.483 1011.44,990.265 1013.75,1033.03 1016.06,1039.69 1018.36,903.358 1020.67,1006.27 1022.98,1024.64 1025.29,929.237 1027.59,1045.51 1029.9,949.571 1032.21,1028.65 1034.52,978.267 1036.83,944.048 1039.13,895.311 1041.44,776.536 1043.75,1052.75 1046.06,1051.48 1048.37,1039.18 1050.67,921.231 1052.98,1151.57 1055.29,822.274 1057.6,871.04 1059.91,686.301 1062.21,1048.16 1064.52,947.259 1066.83,902.894 1069.14,987.689 1071.45,955.161 1073.75,956.425 1076.06,941.646 1078.37,1039.23 1080.68,890.961 1082.98,1252.14 1085.29,929.065 1087.6,914.329 1089.91,783.11 1092.22,820.77 1094.52,987.358 1096.83,1042.24 1099.14,1133.13 1101.45,947.845 1103.76,784.373 1106.06,867.385 1108.37,716.844 1110.68,1057.81 1112.99,957.451 1115.3,825.302 1117.6,984.124 1119.91,1102 1122.22,957.283 1124.53,926.388 1126.84,1093.57 1129.14,893.365 1131.45,856.129 1133.76,945.799 1136.07,895.447 1138.37,1059.56 1140.68,787.824 1142.99,939.915 1145.3,1031.24 1147.61,1166.9 1149.91,892.15 1152.22,831.791 1154.53,902.059 1156.84,988.004 1159.15,903.052 1161.45,854.159 1163.76,746.357 1166.07,927.987 1168.38,1026.02 1170.69,989.568 1172.99,838.4 1175.3,983.188 1177.61,989.551 1179.92,1131.45 1182.23,1116.65 1184.53,964.839 1186.84,1073.01 1189.15,916.311 1191.46,1058.98 1193.76,902.03 1196.07,1124.87 1198.38,948.34 1200.69,1006.5 1203,859.094 1205.3,800.981 1207.61,913.339 1209.92,779.077 1212.23,943.409 1214.54,982.524 1216.84,1007.45 1219.15,1064.65 1221.46,953.344 1223.77,1086.91 1226.08,903.76 1228.38,945.303 1230.69,1025.07 1233,1016.8 1235.31,1060.78 1237.61,1044.45 1239.92,810.106 1242.23,908.502 1244.54,858.65 1246.85,841.845 1249.15,947.977 1251.46,998.007 1253.77,1043.28 1256.08,890.119 1258.39,841.267 1260.69,813.653 1263,879.444 1265.31,1067.94 1267.62,793.593 1269.93,855.84 1272.23,879.287 1274.54,842.902 1276.85,1110.79 1279.16,1006.38 1281.47,1034.34 1283.77,901.698 1286.08,792.604 1288.39,940.14 1290.7,858.779 1293,605.411 1295.31,949.494 1297.62,1001.45 1299.93,965.237 1302.24,959.375 1304.54,930.538 1306.85,984.399 1309.16,930.894 1311.47,1001.51 1313.78,897.65 1316.08,865.031 1318.39,978.628 1320.7,864.546 1323.01,949.55 1325.32,873.912 1327.62,1075.95 1329.93,781.371 1332.24,1017.46 1334.55,847.391 1336.86,1025.1 1339.16,909.725 1341.47,1174.79 1343.78,890.313 1346.09,1026.49 1348.39,940.7 1350.7,875.632 1353.01,932.963 1355.32,1017.76 1357.63,908.363 1359.93,980.587 1362.24,873.718 1364.55,991.852 1366.86,951.663 1369.17,997.91 1371.47,978.655 1373.78,921.078 1376.09,964.742 1378.4,912.72 1380.71,980.684 1383.01,961.873 1385.32,1064.11 1387.63,932.667 1389.94,1042.14 1392.24,965.082 1394.55,1094.07 1396.86,974.575 1399.17,972.277 1401.48,989.317 1403.78,1033.49 1406.09,919.99 1408.4,851.74 1410.71,928.702 1413.02,648.868 1415.32,874.369 1417.63,824.288 1419.94,894.399 1422.25,1022.57 1424.56,956.703 1426.86,759.754 1429.17,1052.72 1431.48,878.562 1433.79,1036.59 1436.1,862.742 1438.4,967.927 1440.71,1054.78 1443.02,1077.94 1445.33,965.904 1447.63,1024.12 1449.94,927.895 1452.25,1105.77 1454.56,903.971 1456.87,808.052 1459.17,945.828 1461.48,1085.1 1463.79,1145.14 1466.1,978.487 1468.41,1012.94 1470.71,891.633 1473.02,932.743 1475.33,1058.29 1477.64,955.473 1479.95,969.934 1482.25,676.432 1484.56,941.134 1486.87,1181.38 1489.18,966.641 1491.49,1038.6 1493.79,849.307 1496.1,926.575 1498.41,1022.98 1500.72,880.443 1503.02,800.687 1505.33,894.376 1507.64,924.075 1509.95,1075.89 1512.26,939.8 1514.56,759.52 1516.87,849.431 1519.18,907.741 1521.49,893.392 1523.8,824.379 1526.1,952.282 1528.41,1187.24 1530.72,1117.3 1533.03,966.42 1535.34,1087.02 1537.64,916.632 1539.95,810.478 1542.26,828.32 1544.57,772.421 1546.88,862.866 1549.18,851.839 1551.49,893.363 1553.8,964.018 1556.11,695.738 1558.41,859.181 1560.72,815.216 1563.03,963.096 1565.34,670.689 1567.65,905.594 1569.95,1038.33 1572.26,1003.04 1574.57,953.896 1576.88,956.614 1579.19,823.395 1581.49,746.175 1583.8,867.52 1586.11,1086.13 1588.42,787.566 1590.73,1227.95 1593.03,742.242 1595.34,931.849 1597.65,846.701 1599.96,973.049 1602.26,962.674 1604.57,959.614 1606.88,1070.46 1609.19,1027.4 1611.5,1020.17 1613.8,857.578 1616.11,906.287 1618.42,986.453 1620.73,1029.46 1623.04,736.758 1625.34,862.885 1627.65,1116.29 1629.96,1025.27 1632.27,1100.37 1634.58,883.305 1636.88,1001.9 1639.19,975.198 1641.5,970.468 1643.81,1054.86 1646.12,843.163 1648.42,996.814 1650.73,977.217 1653.04,1031.33 1655.35,934.991 1657.65,904.373 1659.96,1013.56 1662.27,1039.61 1664.58,1146.96 1666.89,906.323 1669.19,1012.31 1671.5,1021.09 1673.81,842.632 1676.12,1046.73 1678.43,1028.54 1680.73,966.305 1683.04,817.479 1685.35,923.106 1687.66,823.938 1689.97,952.829 1692.27,948.838 1694.58,1070.22 1696.89,983.526 1699.2,1035.79 1701.51,1051.89 1703.81,1004.61 1706.12,883.46 1708.43,852.531 1710.74,901.951 1713.04,918.165 1715.35,749.955 1717.66,992.243 1719.97,892.432 1722.28,829.254 1724.58,841.735 1726.89,978.564 1729.2,762.891 1731.51,844.359 1733.82,1089.26 1736.12,1075.78 1738.43,946.116 1740.74,1035.57 1743.05,1042.97 1745.36,991.026 1747.66,964.399 1749.97,808.305 1752.28,931.596 1754.59,1017.35 1756.9,977.569 1759.2,887.365 1761.51,991.066 1763.82,913.634 1766.13,953.131 1768.43,963.224 1770.74,1018.93 1773.05,688.875 1775.36,730.332 1777.67,1070.04 1779.97,818.113 1782.28,885.422 1784.59,943.977 1786.9,1109.44 1789.21,1153.69 1791.51,966.137 1793.82,1129.45 1796.13,929.54 1798.44,988.064 1800.75,935.979 1803.05,883.586 1805.36,1029.46 1807.67,776.383 1809.98,790.709 1812.28,973.698 1814.59,930.911 1816.9,982.395 1819.21,871.452 1821.52,893.101 1823.82,1076.7 1826.13,964.619 1828.44,847.973 1830.75,1066.28 1833.06,1098.15 1835.36,966.355 1837.67,819.168 1839.98,1064.12 1842.29,1163.74 1844.6,1029.61 1846.9,900.907 1849.21,960.452 1851.52,1045.13 1853.83,895.985 1856.14,821.634 1858.44,914.439 1860.75,988.789 1863.06,765.253 1865.37,934.799 1867.67,758.773 1869.98,802.478 1872.29,1122.67 1874.6,709.35 1876.91,931.768 1879.21,868.226 1881.52,1102.06 1883.83,965.356 1886.14,896.142 1888.45,875.789 1890.75,1033.72 1893.06,878.905 1895.37,1131.16 1897.68,1035.42 1899.99,1051.39 1902.29,1013.11 1904.6,986.049 1906.91,763.362 1909.22,871.441 1911.53,924.561 1913.83,730.617 1916.14,987.344 1918.45,1084.47 1920.76,975.909 1923.06,834.337 1925.37,813.027 1927.68,782.742 1929.99,814.039 1932.3,982.625 1934.6,1011.37 1936.91,991.481 1939.22,837.168 1941.53,921.714 1943.84,1095.14 1946.14,886.611 1948.45,915.258 1950.76,963.148 1953.07,900.503 1955.38,744.163 1957.68,1002.8 1959.99,835.191 1962.3,817.306 1964.61,733.575 1966.91,898.592 1969.22,853.787 1971.53,899.494 1973.84,1102.65 1976.15,919.675 1978.45,904.592 1980.76,924.639 1983.07,974.134 1985.38,1212.13 1987.69,1085.06 1989.99,866.238 1992.3,854.554 1994.61,834.3 1996.92,841.814 1999.23,1102.54 2001.53,779.667 2003.84,961.336 2006.15,1038.54 2008.46,909.18 2010.77,860.394 2013.07,1051.3 2015.38,895.112 2017.69,863.172 2020,803.114 2022.3,1127.38 2024.61,851.143 2026.92,1167.32 2029.23,1069.34 2031.54,1141.96 2033.84,867.226 2036.15,890.152 2038.46,986.376 2040.77,927.985 2043.08,958.726 2045.38,975.291 2047.69,1073.72 2050,945.023 2052.31,842.786 2054.62,1086.67 2056.92,906.442 2059.23,817.38 2061.54,817.605 2063.85,990.318 2066.16,969.665 2068.46,1003.24 2070.77,982.106 2073.08,949.322 2075.39,990.225 2077.69,981.196 2080,868.622 2082.31,970.586 2084.62,916.455 2086.93,788.704 2089.23,1062.54 2091.54,869.839 2093.85,912.526 2096.16,913.534 2098.47,825.825 2100.77,933.812 2103.08,930.806 2105.39,1008.71 2107.7,870.409 2110.01,991.339 2112.31,783.465 2114.62,966.727 2116.93,881.612 2119.24,1007.48 2121.55,1015.2 2123.85,800.077 2126.16,914.736 2128.47,790.285 2130.78,971.681 2133.08,845.712 2135.39,731.482 2137.7,900.289 2140.01,876.448 2142.32,732.411 2144.62,989.881 2146.93,874.878 2149.24,1057.54 2151.55,973.951 2153.86,845.421 2156.16,974.025 2158.47,992.01 2160.78,894.347 2163.09,868.809 2165.4,945.451 2167.7,927.416 2170.01,966.527 2172.32,1078.57 2174.63,999.88 2176.93,1048.15 2179.24,1041.43 2181.55,938.553 2183.86,1019.67 2186.17,969.106 2188.47,1004.04 2190.78,1076.56 2193.09,816.681 2195.4,937.768 2197.71,907.26 2200.01,879.074 2202.32,949.953 2204.63,959.18 2206.94,811.835 2209.25,991.041 2211.55,836.542 2213.86,805.887 2216.17,849.045 2218.48,722.378 2220.79,891.246 2223.09,1024.33 2225.4,1073.59 2227.71,903.043 2230.02,879.796 2232.32,843.257 2234.63,1065.38 2236.94,919.542 2239.25,962.515 2241.56,920.636 2243.86,976.953 2246.17,925.219 2248.48,683.214 2250.79,856.734 2253.1,880.36 2255.4,819.16 2257.71,839.802 2260.02,816.039 2262.33,1003.83 2264.64,883.464 2266.94,892.31 2269.25,977.44 2271.56,1023.05 2273.87,869.826 2276.18,846.768 2278.48,914.576 2280.79,1117.81 2283.1,1037.67 2285.41,1002.75 2287.71,1081.12 2290.02,844.981 2292.33,1169.03 2294.64,1016.58 2296.95,914.975 2299.25,916.122 2301.56,932.735 2303.87,900.706 2306.18,872.107 2308.49,1009.67 2310.79,1166.87 2313.1,872.341 2315.41,866.235 2317.72,852.346 2320.03,889.545 2322.33,1037.31 2324.64,1016.7 2326.95,916.262 2329.26,836.924 2331.56,948.281 2333.87,813.562 2336.18,919.695 2338.49,1123.97 2340.8,1045.27 2343.1,611.1 2345.41,842.519 2347.72,786.324 2350.03,870.876 2352.34,1041.36 2354.64,852.697 2356.95,906.584 2359.26,986.665 2361.57,909.925 2363.88,1063.54 2366.18,896.215 2368.49,907.546 2370.8,862.818 2373.11,994.081 2375.42,912.159 2377.72,1045.32 2380.03,864.573 2382.34,935.828 2384.65,838.257 2386.95,885.563 2389.26,780.467 2391.57,901.802 2393.88,1006.68 2396.19,1027.07 2398.49,991.621 2400.8,1017.33 2403.11,969.012 2405.42,995.824 2407.73,1002.36 2410.03,872.123 2412.34,988.241 2414.65,1051.75 2416.96,890.412 2419.27,966.874 2421.57,898.997 2423.88,797.648 2426.19,832.137 2428.5,877.728 2430.81,875.794 2433.11,905.733 2435.42,1109.93 2437.73,815.128 2440.04,1026.51 2442.34,934.725 2444.65,869.503 2446.96,972.721 2449.27,924.541 2451.58,860.758 2453.88,917.32 2456.19,955.981 2458.5,750.321 2460.81,971.09 2463.12,984.732 2465.42,975.457 2467.73,839.496 2470.04,830.796 2472.35,1010.29 2474.66,935.812 2476.96,866.227 2479.27,997.594 2481.58,965.89 2483.89,895.385 2486.2,927.16 2488.5,1154.91 2490.81,788.277 2493.12,902.968 2495.43,958.627 2497.73,977.788 2500.04,953.635 2502.35,979.611 2504.66,902.242 2506.97,823.168 2509.27,1032.83 2511.58,685.906 2513.89,954.639 2516.2,860.871 2518.51,781.391 2520.81,686.568 2523.12,859.319 2525.43,891.179 2527.74,1039.05 2530.05,964.182 2532.35,1018.02 2534.66,790.233 2536.97,1094.35 2539.28,792.195 2541.58,919.142 2543.89,904.077 2546.2,1056.51 2548.51,802.513 2550.82,910.693 2553.12,1012.39 2555.43,948.546 2557.74,979.778 2560.05,968.766 2562.36,1148.54 2564.66,684.695 2566.97,948.102 2569.28,1055.37 2571.59,837.365 "></polyline>
<polyline clip-path="url(#clip672)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,726.2 268.292,529.245 270.6,176.363 272.908,507.637 275.216,356.144 277.524,533.459 279.832,540.937 282.139,473.381 284.447,254.735 286.755,485.151 289.063,473.413 291.371,392.542 293.679,505.592 295.987,477.24 298.295,385.008 300.603,502.923 302.911,445.601 305.219,593.087 307.527,390.602 309.834,319.105 312.142,400.696 314.45,453.644 316.758,567.767 319.066,418.282 321.374,411.154 323.682,324.504 325.99,452.739 328.298,342.985 330.606,427.179 332.914,420.979 335.221,348.568 337.529,401.638 339.837,419.418 342.145,384.047 344.453,466.901 346.761,551.155 349.069,526.734 351.377,575.431 353.685,613.77 355.993,453.266 358.301,355.4 360.608,438.964 362.916,397.302 365.224,171.544 367.532,422.136 369.84,346.464 372.148,335.542 374.456,563.274 376.764,522.832 379.072,491.539 381.38,435.988 383.688,624.183 385.996,505.047 388.303,344.874 390.611,600.463 392.919,429.639 395.227,699.694 397.535,586.904 399.843,398.557 402.151,406.45 404.459,406.24 406.767,431.466 409.075,536.828 411.383,383.046 413.69,657.188 415.998,449.965 418.306,577.931 420.614,419.353 422.922,444.182 425.23,407.452 427.538,427.633 429.846,367.608 432.154,363.67 434.462,419.592 436.77,527.381 439.077,358.341 441.385,238.163 443.693,398.967 446.001,460.324 448.309,290.786 450.617,503.071 452.925,594.378 455.233,472.687 457.541,609.556 459.849,469.818 462.157,535.373 464.465,382.088 466.772,386.434 469.08,601.146 471.388,445.147 473.696,305.984 476.004,426.436 478.312,401.588 480.62,390.008 482.928,441.061 485.236,375.224 487.544,491.548 489.852,555.332 492.159,376.468 494.467,383.732 496.775,687.767 499.083,368.501 501.391,599.184 503.699,374.235 506.007,374.19 508.315,343.539 510.623,402.858 512.931,471.997 515.239,450.103 517.546,407.562 519.854,405.876 522.162,507.411 524.47,586.378 526.778,243.185 529.086,382.511 531.394,428.743 533.702,589.552 536.01,573.616 538.318,576.905 540.626,588.264 542.933,450.66 545.241,474.958 547.549,367.571 549.857,469.779 552.165,494.486 554.473,409.549 556.781,278.384 559.089,378.28 561.397,541.916 563.705,632.384 566.013,418.68 568.321,446.877 570.628,477.783 572.936,475.234 575.244,510.569 577.552,466.637 579.86,356.31 582.168,512.04 584.476,368.187 586.784,566.63 589.092,514.105 591.4,417.874 593.708,494.81 596.015,532.242 598.323,298.063 600.631,413.77 602.939,521.631 605.247,414.186 607.555,450.167 609.863,497.194 612.171,523.759 614.479,470.836 616.787,574.779 619.095,453.205 621.402,318.521 623.71,326.549 626.018,556.82 628.326,512.443 630.634,272.676 632.942,608.547 635.25,300.336 637.558,445.54 639.866,595.735 642.174,366.125 644.482,515.726 646.79,579.725 649.097,653.317 651.405,528.036 653.713,490.201 656.021,331.133 658.329,463.195 660.637,408.937 662.945,415.284 665.253,567.772 667.561,233.263 669.869,321.752 672.177,290.09 674.484,422.568 676.792,551.26 679.1,356.767 681.408,362.5 683.716,491.386 686.024,405.057 688.332,248.094 690.64,529.127 692.948,422.53 695.256,529.249 697.564,513.666 699.871,594.448 702.179,540.742 704.487,545.565 706.795,517.872 709.103,379.792 711.411,487.161 713.719,614.267 716.027,395.003 718.335,590.295 720.643,518.805 722.951,457.605 725.259,507.754 727.566,433.962 729.874,591.59 732.182,495.607 734.49,483.717 736.798,431.556 739.106,361.838 741.414,341.759 743.722,475.636 746.03,397.983 748.338,530.664 750.646,519.264 752.953,423.092 755.261,313.498 757.569,489.349 759.877,286.561 762.185,541.187 764.493,322.649 766.801,342.172 769.109,522.288 771.417,543.137 773.725,412.565 776.033,511.572 778.34,412.411 780.648,305.714 782.956,538.282 785.264,281.352 787.572,345.823 789.88,596.799 792.188,460.682 794.496,585.663 796.804,544.252 799.112,507.742 801.42,345.629 803.728,447.298 806.035,434.135 808.343,321.637 810.651,428.548 812.959,364.795 815.267,272.873 817.575,449.814 819.883,530.933 822.191,364.696 824.499,538.842 826.807,253.859 829.115,316.868 831.422,515.911 833.73,259.887 836.038,432.462 838.346,484.044 840.654,449.983 842.962,364.837 845.27,431.851 847.578,404.644 849.886,401.298 852.194,473.284 854.502,322.525 856.809,552.111 859.117,454.469 861.425,479.134 863.733,514.9 866.041,396.349 868.349,503.724 870.657,508.578 872.965,395.14 875.273,600.973 877.581,404.514 879.889,378.625 882.197,318.237 884.504,538.072 886.812,625.246 889.12,387.53 891.428,299.64 893.736,397.783 896.044,365.901 898.352,461.582 900.66,249.156 902.968,613.285 905.276,576.737 907.584,463.849 909.891,444.007 912.199,185.189 914.507,430.137 916.815,532.601 919.123,419.857 921.431,432.64 923.739,411.403 926.047,455.544 928.355,412.506 930.663,452.076 932.971,362.696 935.278,445.736 937.586,394.803 939.894,508.99 942.202,527.351 944.51,420.445 946.818,557.696 949.126,324.964 951.434,551.605 953.742,503.123 956.05,370.457 958.358,468.95 960.665,580.079 962.973,394.606 965.281,297.769 967.589,376.934 969.897,378.993 972.205,544.957 974.513,454.189 976.821,423.301 979.129,443.589 981.437,553.804 983.745,620.011 986.053,550.768 988.36,339.029 990.668,476.723 992.976,426.821 995.284,434.834 997.592,313.106 999.9,466.045 1002.21,459.645 1004.52,401.162 1006.82,554.628 1009.13,419.192 1011.44,535.143 1013.75,334.431 1016.06,639.642 1018.36,489.22 1020.67,568.496 1022.98,468.375 1025.29,427.488 1027.59,419.622 1029.9,428.828 1032.21,417.683 1034.52,538.031 1036.83,357.427 1039.13,445.771 1041.44,367.067 1043.75,427.031 1046.06,363.665 1048.37,665.23 1050.67,424.226 1052.98,276.923 1055.29,493.973 1057.6,492.562 1059.91,435.143 1062.21,579.031 1064.52,496.62 1066.83,575.633 1069.14,500.215 1071.45,437.252 1073.75,563.808 1076.06,498.35 1078.37,513.781 1080.68,543.322 1082.98,563.414 1085.29,385.891 1087.6,507.41 1089.91,504.4 1092.22,483.254 1094.52,441.694 1096.83,434.212 1099.14,479.56 1101.45,446.179 1103.76,478.198 1106.06,363.151 1108.37,451.367 1110.68,297.07 1112.99,482.83 1115.3,358.801 1117.6,497.608 1119.91,558.201 1122.22,437.616 1124.53,615.864 1126.84,343.177 1129.14,570.928 1131.45,368.008 1133.76,525.867 1136.07,548.55 1138.37,550.971 1140.68,675.657 1142.99,434.472 1145.3,434.796 1147.61,417.096 1149.91,568.79 1152.22,503.741 1154.53,440.55 1156.84,396.792 1159.15,398.456 1161.45,395.967 1163.76,396.844 1166.07,96.8724 1168.38,262.011 1170.69,337.624 1172.99,299.541 1175.3,424.812 1177.61,454.264 1179.92,452.002 1182.23,432.039 1184.53,551.904 1186.84,427.711 1189.15,405.161 1191.46,450.329 1193.76,320.361 1196.07,399.236 1198.38,403.457 1200.69,450.592 1203,342.185 1205.3,510.932 1207.61,459.351 1209.92,497.876 1212.23,426.381 1214.54,474.592 1216.84,374.652 1219.15,361.249 1221.46,215.738 1223.77,448.496 1226.08,386.881 1228.38,526.788 1230.69,399.81 1233,319.66 1235.31,658.723 1237.61,615.382 1239.92,515.844 1242.23,339.373 1244.54,339.076 1246.85,509.782 1249.15,447.149 1251.46,282.88 1253.77,470.013 1256.08,460.017 1258.39,570.153 1260.69,430.424 1263,387.814 1265.31,470.027 1267.62,415.955 1269.93,490.542 1272.23,499.171 1274.54,441.815 1276.85,493.483 1279.16,469.859 1281.47,495.301 1283.77,434.67 1286.08,600.987 1288.39,522.311 1290.7,333.614 1293,414.302 1295.31,401.845 1297.62,299.02 1299.93,434.229 1302.24,467.424 1304.54,626.418 1306.85,541.638 1309.16,363.171 1311.47,585.139 1313.78,592.012 1316.08,401.476 1318.39,398.945 1320.7,350.786 1323.01,482.867 1325.32,476.242 1327.62,566.915 1329.93,350.705 1332.24,422.62 1334.55,510.188 1336.86,404.812 1339.16,399.198 1341.47,450.29 1343.78,561.514 1346.09,510.523 1348.39,259.11 1350.7,460.874 1353.01,615.232 1355.32,413.833 1357.63,537.209 1359.93,584.546 1362.24,483.106 1364.55,365.859 1366.86,358.025 1369.17,475.019 1371.47,569.421 1373.78,394.903 1376.09,437.319 1378.4,361.557 1380.71,618.884 1383.01,452.203 1385.32,728.714 1387.63,386.972 1389.94,496.502 1392.24,221.283 1394.55,495.744 1396.86,406.617 1399.17,263.194 1401.48,246.911 1403.78,419.398 1406.09,495.4 1408.4,462.692 1410.71,482.667 1413.02,388.966 1415.32,498.552 1417.63,508.254 1419.94,421.658 1422.25,396.031 1424.56,437.594 1426.86,516.262 1429.17,490.434 1431.48,525.889 1433.79,486.683 1436.1,307.325 1438.4,418.329 1440.71,494.218 1443.02,391.114 1445.33,436.615 1447.63,590.35 1449.94,277.837 1452.25,505.625 1454.56,456.777 1456.87,424.384 1459.17,593.362 1461.48,377.431 1463.79,431.885 1466.1,449.609 1468.41,621.76 1470.71,532.507 1473.02,444.184 1475.33,360.168 1477.64,277.873 1479.95,453.321 1482.25,437.144 1484.56,608.85 1486.87,307.049 1489.18,486.248 1491.49,306.012 1493.79,353.28 1496.1,547.232 1498.41,437.521 1500.72,546.127 1503.02,393.236 1505.33,424.384 1507.64,374.252 1509.95,436.873 1512.26,596.026 1514.56,328.707 1516.87,355.014 1519.18,279.173 1521.49,539.199 1523.8,509.082 1526.1,463.19 1528.41,294.507 1530.72,471.623 1533.03,512.621 1535.34,416.64 1537.64,405.091 1539.95,390.591 1542.26,402.885 1544.57,615.889 1546.88,281.1 1549.18,515.529 1551.49,573.365 1553.8,464.322 1556.11,551 1558.41,550.322 1560.72,291.647 1563.03,471.688 1565.34,411.433 1567.65,292.721 1569.95,385.751 1572.26,423.205 1574.57,558.799 1576.88,334.836 1579.19,572.986 1581.49,263.273 1583.8,338.023 1586.11,294.031 1588.42,499.184 1590.73,438.653 1593.03,329.709 1595.34,432.146 1597.65,259.493 1599.96,435.225 1602.26,276.986 1604.57,540.654 1606.88,611.167 1609.19,602.172 1611.5,314.853 1613.8,341.096 1616.11,539.455 1618.42,522.415 1620.73,538.108 1623.04,364.507 1625.34,454.538 1627.65,478.881 1629.96,460.022 1632.27,251.672 1634.58,321.551 1636.88,497.374 1639.19,291.93 1641.5,366.289 1643.81,396.894 1646.12,487.359 1648.42,398.088 1650.73,422.993 1653.04,382.891 1655.35,521.659 1657.65,630.207 1659.96,475.902 1662.27,518.379 1664.58,380.488 1666.89,535.874 1669.19,424.509 1671.5,417.269 1673.81,525.262 1676.12,390.34 1678.43,524.055 1680.73,388.879 1683.04,517.248 1685.35,498.827 1687.66,293.787 1689.97,441.517 1692.27,212.509 1694.58,508.637 1696.89,539.797 1699.2,442.484 1701.51,406.789 1703.81,637.353 1706.12,569.871 1708.43,545.335 1710.74,374.292 1713.04,485.947 1715.35,329.239 1717.66,487.617 1719.97,398.198 1722.28,380.403 1724.58,437.509 1726.89,468.088 1729.2,564.526 1731.51,324.882 1733.82,479.191 1736.12,470.397 1738.43,256.207 1740.74,533.029 1743.05,471.571 1745.36,528.452 1747.66,455.204 1749.97,363.544 1752.28,377.327 1754.59,397.661 1756.9,656.038 1759.2,548.027 1761.51,357.706 1763.82,428.305 1766.13,438.179 1768.43,500.578 1770.74,735.26 1773.05,282.203 1775.36,283.105 1777.67,515.246 1779.97,416.177 1782.28,511.878 1784.59,423.85 1786.9,489.798 1789.21,558.081 1791.51,408.381 1793.82,373.163 1796.13,478.521 1798.44,438.462 1800.75,541.095 1803.05,519.012 1805.36,454.13 1807.67,507.061 1809.98,447.853 1812.28,341.938 1814.59,414.252 1816.9,335.923 1819.21,525.494 1821.52,549.354 1823.82,469.26 1826.13,422.677 1828.44,317.832 1830.75,474.745 1833.06,393.787 1835.36,483.496 1837.67,460.233 1839.98,363.389 1842.29,733.689 1844.6,485.063 1846.9,587.397 1849.21,503.41 1851.52,591.321 1853.83,412.943 1856.14,530.445 1858.44,239.043 1860.75,398.676 1863.06,336.876 1865.37,653.48 1867.67,478.709 1869.98,362.742 1872.29,565.602 1874.6,357.8 1876.91,410.585 1879.21,597.747 1881.52,462.798 1883.83,430.55 1886.14,463.637 1888.45,465.36 1890.75,429.809 1893.06,443.037 1895.37,528.701 1897.68,532.673 1899.99,356.618 1902.29,395.883 1904.6,274.241 1906.91,451.281 1909.22,391.127 1911.53,515.935 1913.83,571.61 1916.14,426.888 1918.45,270.58 1920.76,292.778 1923.06,388.707 1925.37,325.901 1927.68,466.468 1929.99,269.746 1932.3,370.608 1934.6,455.777 1936.91,362.135 1939.22,497.468 1941.53,421.918 1943.84,206.618 1946.14,477.752 1948.45,495.586 1950.76,659.591 1953.07,523.512 1955.38,478.95 1957.68,255.142 1959.99,575.268 1962.3,426.775 1964.61,403.369 1966.91,482.634 1969.22,516.073 1971.53,334.432 1973.84,258.489 1976.15,584.449 1978.45,447.171 1980.76,393.012 1983.07,547.225 1985.38,439.512 1987.69,530.919 1989.99,428.782 1992.3,246.017 1994.61,639.305 1996.92,465.687 1999.23,547.926 2001.53,319.01 2003.84,376.958 2006.15,479.792 2008.46,459.532 2010.77,330.667 2013.07,483.057 2015.38,457.477 2017.69,500.571 2020,490.136 2022.3,584.699 2024.61,479.615 2026.92,554.609 2029.23,454.378 2031.54,469.938 2033.84,415.592 2036.15,442.956 2038.46,537.521 2040.77,402.096 2043.08,474.1 2045.38,457.095 2047.69,203.894 2050,580.685 2052.31,623.329 2054.62,497.747 2056.92,594.976 2059.23,344.692 2061.54,418.288 2063.85,527.009 2066.16,570.534 2068.46,443.072 2070.77,371.616 2073.08,557.304 2075.39,406.048 2077.69,586.155 2080,467.971 2082.31,435.097 2084.62,588.032 2086.93,263.559 2089.23,421.304 2091.54,474.18 2093.85,543.215 2096.16,531.231 2098.47,594.032 2100.77,363.343 2103.08,553.082 2105.39,396.247 2107.7,140.898 2110.01,580.996 2112.31,414.488 2114.62,378.951 2116.93,541.237 2119.24,463.697 2121.55,435.05 2123.85,414.744 2126.16,499.118 2128.47,646.275 2130.78,423.256 2133.08,388.701 2135.39,574.311 2137.7,414.852 2140.01,417.056 2142.32,468.251 2144.62,432.29 2146.93,521.912 2149.24,664.268 2151.55,394.268 2153.86,408.32 2156.16,455.475 2158.47,638.691 2160.78,314.212 2163.09,519.407 2165.4,366.136 2167.7,494.772 2170.01,370.179 2172.32,476.055 2174.63,500.86 2176.93,396.377 2179.24,540.495 2181.55,516.265 2183.86,410.966 2186.17,536.715 2188.47,357.662 2190.78,381.785 2193.09,490.471 2195.4,308.521 2197.71,604.243 2200.01,440.448 2202.32,504.327 2204.63,457.227 2206.94,387.579 2209.25,477.076 2211.55,527.804 2213.86,451.884 2216.17,465.041 2218.48,495.285 2220.79,495.359 2223.09,379.583 2225.4,487.322 2227.71,595.662 2230.02,480.454 2232.32,556.042 2234.63,253.387 2236.94,342.098 2239.25,483.384 2241.56,529.229 2243.86,336.487 2246.17,554.841 2248.48,472.198 2250.79,456.867 2253.1,456.458 2255.4,551.327 2257.71,620.332 2260.02,608.846 2262.33,476.116 2264.64,381.32 2266.94,458.544 2269.25,494.072 2271.56,436.215 2273.87,424.009 2276.18,370.124 2278.48,486.266 2280.79,561.409 2283.1,438.787 2285.41,403.657 2287.71,554.314 2290.02,547.271 2292.33,430.112 2294.64,559.085 2296.95,511.774 2299.25,458.922 2301.56,419.268 2303.87,528.036 2306.18,494.711 2308.49,598.487 2310.79,539.178 2313.1,523.635 2315.41,567.313 2317.72,479.551 2320.03,292.912 2322.33,551.361 2324.64,416.773 2326.95,491.13 2329.26,480.321 2331.56,319.017 2333.87,467.417 2336.18,334.103 2338.49,302.935 2340.8,523.997 2343.1,536.15 2345.41,464.033 2347.72,322.424 2350.03,273.083 2352.34,301.551 2354.64,356.782 2356.95,363.284 2359.26,529.5 2361.57,548.684 2363.88,290.858 2366.18,445.01 2368.49,437.78 2370.8,533.893 2373.11,376.146 2375.42,461.384 2377.72,555.341 2380.03,304.175 2382.34,506.764 2384.65,474.34 2386.95,472.083 2389.26,526.393 2391.57,386.395 2393.88,499.611 2396.19,454.688 2398.49,382.747 2400.8,507.453 2403.11,200.671 2405.42,448.346 2407.73,527.027 2410.03,174.229 2412.34,467.891 2414.65,680.13 2416.96,470.864 2419.27,492.15 2421.57,599.634 2423.88,443.046 2426.19,297.955 2428.5,514.213 2430.81,552.53 2433.11,412.532 2435.42,516.651 2437.73,275.52 2440.04,515.854 2442.34,479.62 2444.65,367.124 2446.96,377.167 2449.27,553.483 2451.58,467.987 2453.88,495.102 2456.19,552.871 2458.5,446.749 2460.81,442.261 2463.12,487.16 2465.42,358.743 2467.73,558.682 2470.04,439.29 2472.35,273.008 2474.66,351.099 2476.96,487.09 2479.27,371.843 2481.58,324.649 2483.89,521.993 2486.2,545.967 2488.5,439.227 2490.81,349.964 2493.12,531.589 2495.43,486.706 2497.73,550.498 2500.04,334.951 2502.35,527.402 2504.66,378.944 2506.97,447.996 2509.27,556.289 2511.58,369.952 2513.89,493.212 2516.2,525.21 2518.51,387.044 2520.81,519.695 2523.12,588.9 2525.43,424.745 2527.74,318.928 2530.05,505.821 2532.35,446.299 2534.66,388.477 2536.97,561.36 2539.28,500.876 2541.58,439.838 2543.89,452.034 2546.2,334.03 2548.51,322.315 2550.82,447.848 2553.12,518.475 2555.43,458.415 2557.74,406.142 2560.05,262.376 2562.36,570.375 2564.66,439.257 2566.97,570.239 2569.28,494.88 2571.59,496.023 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -1.28604  -4.62862  -5.63786  -5.36033   …  -5.48478   -4.27587   -4.63523
 -1.04758  -2.40421  -1.97874  -0.734793      0.355117   0.172666  -0.5792
  1.68231   3.70535   3.80711   4.71698       5.62279    4.24296    3.4409

[:, :, 2] =
 -2.80724   -2.75264   -3.69957   …  -5.23541   -6.11541   -4.92664
 -0.372068   0.464558   0.344249     -0.291245   0.754335   0.749094
  2.32502    3.34506    3.12584       5.30042    7.05063    4.703

[:, :, 3] =
 -2.65573   -3.54662   -4.06532  -3.92541   …  -5.53459  -5.23189   -5.59598
 -0.330853   0.208296   1.66763  -0.222953     -1.05726  -0.894901   2.50629
  1.74137    4.31674    5.43956   4.88329       4.92968   6.67356    5.94828

[:, :, 4] =
 -1.38302     -4.44977   -4.33056   …  -5.9606    -6.87908   -5.95246
 -0.00114306   0.335116   0.461302     -0.537689  -0.510285  -0.862372
  0.252215     0.713188   3.83225       5.36061    6.34864    6.06013</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.97709     0.981902
  0.00998917  0.996457
  5.02976     0.990951</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="ansi-escaped-output">
<pre>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.54 seconds
Compute duration  = 2.54 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    mean </span> <span class="ansi-bold">     std </span> <span class="ansi-bold">    mcse </span> <span class="ansi-bold">  ess_bulk </span> <span class="ansi-bold">  ess_tail </span> <span class="ansi-bold">    rhat </span>  ⋯
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg">   Float64 </span> <span class="ansi-bright-black-fg">   Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span>  ⋯

        x[1]   -5.0092    0.9835    0.0170   3339.6152   5243.7730    1.0000   ⋯
        x[2]   -0.0014    1.0065    0.0172   3448.1014   5076.0453    1.0000   ⋯
        x[3]    5.0207    1.0164    0.0175   3359.9184   4982.1012    1.0001   ⋯
<span class="ansi-cyan-fg">                                                                1 column omitted</span>

Quantiles
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    2.5% </span> <span class="ansi-bold">   25.0% </span> <span class="ansi-bold">   50.0% </span> <span class="ansi-bold">   75.0% </span> <span class="ansi-bold">   97.5% </span>
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span>

        x[1]   -6.9196   -5.6549   -5.0121   -4.3527   -3.0512
        x[2]   -1.9502   -0.6863   -0.0037    0.6880    1.9817
        x[3]    3.0237    4.3387    5.0150    5.7115    6.9959
</pre>
</div>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="ansi-escaped-output">
<pre>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.64 seconds
Compute duration  = 1.64 seconds
parameters        = x
internals         = lp

Summary Statistics
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    mean </span> <span class="ansi-bold">     std </span> <span class="ansi-bold">    mcse </span> <span class="ansi-bold">  ess_bulk </span> <span class="ansi-bold">  ess_tail </span> <span class="ansi-bold">    rhat </span>  ⋯
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg">   Float64 </span> <span class="ansi-bright-black-fg">   Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span>  ⋯

           x    0.4961    0.1895    0.0028   4389.4891   5993.3273    1.0000   ⋯
<span class="ansi-cyan-fg">                                                                1 column omitted</span>

Quantiles
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    2.5% </span> <span class="ansi-bold">   25.0% </span> <span class="ansi-bold">   50.0% </span> <span class="ansi-bold">   75.0% </span> <span class="ansi-bold">   97.5% </span>
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span>

           x    0.1435    0.3570    0.4954    0.6363    0.8501
</pre>
</div>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="ansi-escaped-output">
<pre>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.24 seconds
Compute duration  = 0.24 seconds
parameters        = x
internals         = lp

Summary Statistics
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    mean </span> <span class="ansi-bold">     std </span> <span class="ansi-bold">    mcse </span> <span class="ansi-bold"> ess_bulk </span> <span class="ansi-bold"> ess_tail </span> <span class="ansi-bold">    rhat </span> <span class="ansi-bold"> e</span> ⋯
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg">  Float64 </span> <span class="ansi-bright-black-fg">  Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg">  </span> ⋯

           x    0.5028    0.1297    0.0096   168.0071   121.6697    1.0038     ⋯
<span class="ansi-cyan-fg">                                                                1 column omitted</span>

Quantiles
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    2.5% </span> <span class="ansi-bold">   25.0% </span> <span class="ansi-bold">   50.0% </span> <span class="ansi-bold">   75.0% </span> <span class="ansi-bold">   97.5% </span>
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span>

           x    0.2618    0.4026    0.4988    0.6046    0.7265
</pre>
</div>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre>DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.5863583491378334,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] <span class="ansi-bold">#371</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Distributions/ji8PW/src/univariate/continuous/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">normal.jl:37</span><span class="ansi-bright-black-fg"> [inlined]</span>
  [2] <span class="ansi-bold">check_args</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Distributions/ji8PW/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">utils.jl:89</span><span class="ansi-bright-black-fg"> [inlined]</span>
  [3] <span class="ansi-bold">#Normal#370</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Distributions/ji8PW/src/univariate/continuous/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">normal.jl:37</span><span class="ansi-bright-black-fg"> [inlined]</span>
  [4] <span class="ansi-bold">Normal</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Distributions/ji8PW/src/univariate/continuous/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">normal.jl:36</span><span class="ansi-bright-black-fg"> [inlined]</span>
  [5] <span class="ansi-bold">Normal</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Distributions/ji8PW/src/univariate/continuous/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">normal.jl:42</span><span class="ansi-bright-black-fg"> [inlined]</span>
  [6] <span class="ansi-bold">macro expansion</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/DynamicPPL/E4kDs/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">compiler.jl:579</span><span class="ansi-bright-black-fg"> [inlined]</span>
  [7] <span class="ansi-bold">demo</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">__model__</span>::DynamicPPL.Model<span class="ansi-bright-black-fg">{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}</span>, <span class="ansi-bright-black-fg">__varinfo__</span>::DynamicPPL.ThreadSafeVarInfo<span class="ansi-bright-black-fg">{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}</span>, <span class="ansi-bright-black-fg">__context__</span>::DynamicPPL.DefaultContext<span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-magenta-fg">Main.Notebook</span> <span class="ansi-bright-black-fg">~/work/turing-docs/turing-docs/tutorials/docs-17-implementing-samplers/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">index.qmd:454</span>
  [8] <span class="ansi-bold">_evaluate!!</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/DynamicPPL/E4kDs/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">model.jl:963</span><span class="ansi-bright-black-fg"> [inlined]</span>
  [9] <span class="ansi-bold">evaluate_threadsafe!!</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">model</span>::DynamicPPL.Model<span class="ansi-bright-black-fg">{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}</span>, <span class="ansi-bright-black-fg">varinfo</span>::DynamicPPL.TypedVarInfo<span class="ansi-bright-black-fg">{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}</span>, <span class="ansi-bright-black-fg">context</span>::DynamicPPL.DefaultContext<span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-cyan-fg">DynamicPPL</span> <span class="ansi-bright-black-fg">~/.julia/packages/DynamicPPL/E4kDs/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">model.jl:952</span>
 [10] <span class="ansi-bold">evaluate!!</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/DynamicPPL/E4kDs/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">model.jl:887</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [11] <span class="ansi-bold">logdensity</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/DynamicPPL/E4kDs/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">logdensityfunction.jl:94</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [12] <span class="ansi-bold">Fix1</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">./</span><span style="text-decoration:underline" class="ansi-bright-black-fg">operators.jl:1118</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [13] <span class="ansi-bold">vector_mode_dual_eval!</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">f</span>::Base.Fix1<span class="ansi-bright-black-fg">{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.DefaultContext}}</span>, <span class="ansi-bright-black-fg">cfg</span>::ForwardDiff.GradientConfig<span class="ansi-bright-black-fg">{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}</span>, <span class="ansi-bright-black-fg">x</span>::Vector<span class="ansi-bright-black-fg">{Float64}</span><span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-green-fg">ForwardDiff</span> <span class="ansi-bright-black-fg">~/.julia/packages/ForwardDiff/PcZ48/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">apiutils.jl:24</span>
 [14] <span class="ansi-bold">vector_mode_gradient!</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">result</span>::DiffResults.MutableDiffResult<span class="ansi-bright-black-fg">{1, Float64, Tuple{Vector{Float64}}}</span>, <span class="ansi-bright-black-fg">f</span>::Base.Fix1<span class="ansi-bright-black-fg">{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.DefaultContext}}</span>, <span class="ansi-bright-black-fg">x</span>::Vector<span class="ansi-bright-black-fg">{Float64}</span>, <span class="ansi-bright-black-fg">cfg</span>::ForwardDiff.GradientConfig<span class="ansi-bright-black-fg">{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}</span><span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-green-fg">ForwardDiff</span> <span class="ansi-bright-black-fg">~/.julia/packages/ForwardDiff/PcZ48/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">gradient.jl:96</span>
 [15] <span class="ansi-bold">gradient!</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/ForwardDiff/PcZ48/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">gradient.jl:37</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [16] <span class="ansi-bold">gradient!</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/ForwardDiff/PcZ48/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">gradient.jl:35</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [17] <span class="ansi-bold">logdensity_and_gradient</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/LogDensityProblemsAD/rBlLq/ext/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">LogDensityProblemsADForwardDiffExt.jl:118</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [18] <span class="ansi-bold">leapfrog_step</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">model</span>::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity<span class="ansi-bright-black-fg">{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.DefaultContext}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}</span>, <span class="ansi-bright-black-fg">x</span>::Vector<span class="ansi-bright-black-fg">{Float64}</span>, <span class="ansi-bright-black-fg">p</span>::Vector<span class="ansi-bright-black-fg">{Float64}</span>, <span class="ansi-bright-black-fg">ϵ</span>::Int64, <span class="ansi-bright-black-fg">M</span>::UniformScaling<span class="ansi-bright-black-fg">{Bool}</span><span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-magenta-fg">Main.Notebook</span> <span class="ansi-bright-black-fg">~/work/turing-docs/turing-docs/tutorials/docs-17-implementing-samplers/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">index.qmd:303</span>
 [19] <span class="ansi-bold">step</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">rng</span>::TaskLocalRNG, <span class="ansi-bright-black-fg">model_wrapper</span>::AbstractMCMC.LogDensityModel<span class="ansi-bright-black-fg">{LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.DefaultContext}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}</span>, <span class="ansi-bright-black-fg">sampler</span>::MALA<span class="ansi-bright-black-fg">{Int64, UniformScaling{Bool}}</span>, <span class="ansi-bright-black-fg">state</span>::MALAState<span class="ansi-bright-black-fg">{Vector{Float64}}</span>; <span class="ansi-bright-black-fg">kwargs</span>::@Kwargs<span class="ansi-bright-black-fg">{}</span><span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-magenta-fg">Main.Notebook</span> <span class="ansi-bright-black-fg">~/work/turing-docs/turing-docs/tutorials/docs-17-implementing-samplers/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">index.qmd:274</span>
 [20] <span class="ansi-bold">step</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/work/turing-docs/turing-docs/tutorials/docs-17-implementing-samplers/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">index.qmd:256</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [21] <span class="ansi-bold">#step#108</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Turing/aAIq7/src/mcmc/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">abstractmcmc.jl:90</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [22] <span class="ansi-bold">step</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">rng</span>::TaskLocalRNG, <span class="ansi-bright-black-fg">model</span>::DynamicPPL.Model<span class="ansi-bright-black-fg">{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}</span>, <span class="ansi-bright-black-fg">sampler_wrapper</span>::DynamicPPL.Sampler<span class="ansi-bright-black-fg">{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}</span>, <span class="ansi-bright-black-fg">state</span>::Turing.Inference.TuringState<span class="ansi-bright-black-fg">{MALAState{Vector{Float64}}, LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, DynamicPPL.DefaultContext}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}</span><span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-yellow-fg">Turing.Inference</span> <span class="ansi-bright-black-fg">~/.julia/packages/Turing/aAIq7/src/mcmc/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">abstractmcmc.jl:79</span>
 [23] <span class="ansi-bold">macro expansion</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/AbstractMCMC/YrmkI/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">sample.jl:176</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [24] <span class="ansi-bold">macro expansion</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/AbstractMCMC/YrmkI/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">logging.jl:16</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [25] <span class="ansi-bold">mcmcsample</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">rng</span>::TaskLocalRNG, <span class="ansi-bright-black-fg">model</span>::DynamicPPL.Model<span class="ansi-bright-black-fg">{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}</span>, <span class="ansi-bright-black-fg">sampler</span>::DynamicPPL.Sampler<span class="ansi-bright-black-fg">{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}</span>, <span class="ansi-bright-black-fg">N</span>::Int64; <span class="ansi-bright-black-fg">progress</span>::Bool, <span class="ansi-bright-black-fg">progressname</span>::String, <span class="ansi-bright-black-fg">callback</span>::Nothing, <span class="ansi-bright-black-fg">discard_initial</span>::Int64, <span class="ansi-bright-black-fg">thinning</span>::Int64, <span class="ansi-bright-black-fg">chain_type</span>::Type, <span class="ansi-bright-black-fg">initial_state</span>::Nothing, <span class="ansi-bright-black-fg">kwargs</span>::@Kwargs<span class="ansi-bright-black-fg">{}</span><span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-magenta-fg">AbstractMCMC</span> <span class="ansi-bright-black-fg">~/.julia/packages/AbstractMCMC/YrmkI/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">sample.jl:120</span>
 [26] <span class="ansi-bold">sample</span><span class="ansi-bold">(</span><span class="ansi-bright-black-fg">rng</span>::TaskLocalRNG, <span class="ansi-bright-black-fg">model</span>::DynamicPPL.Model<span class="ansi-bright-black-fg">{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}</span>, <span class="ansi-bright-black-fg">sampler</span>::DynamicPPL.Sampler<span class="ansi-bright-black-fg">{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}</span>, <span class="ansi-bright-black-fg">N</span>::Int64; <span class="ansi-bright-black-fg">chain_type</span>::Type, <span class="ansi-bright-black-fg">resume_from</span>::Nothing, <span class="ansi-bright-black-fg">initial_state</span>::Nothing, <span class="ansi-bright-black-fg">kwargs</span>::@Kwargs<span class="ansi-bright-black-fg">{progress::Bool}</span><span class="ansi-bold">)</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-cyan-fg">DynamicPPL</span> <span class="ansi-bright-black-fg">~/.julia/packages/DynamicPPL/E4kDs/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">sampler.jl:93</span>
 [27] <span class="ansi-bold">sample</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/DynamicPPL/E4kDs/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">sampler.jl:83</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [28] <span class="ansi-bold">#sample#4</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Turing/aAIq7/src/mcmc/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">Inference.jl:263</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [29] <span class="ansi-bold">sample</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Turing/aAIq7/src/mcmc/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">Inference.jl:256</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [30] <span class="ansi-bold">#sample#3</span>
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/.julia/packages/Turing/aAIq7/src/mcmc/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">Inference.jl:253</span><span class="ansi-bright-black-fg"> [inlined]</span>
 [31] top-level scope
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">~/work/turing-docs/turing-docs/tutorials/docs-17-implementing-samplers/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">index.qmd:456</span></pre>
</div>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="ansi-escaped-output">
<pre>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.55 seconds
Compute duration  = 0.55 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    mean </span> <span class="ansi-bold">     std </span> <span class="ansi-bold">    mcse </span> <span class="ansi-bold"> ess_bulk </span> <span class="ansi-bold"> ess_tail </span> <span class="ansi-bold">    rhat </span> <span class="ansi-bold"> e</span> ⋯
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg">  Float64 </span> <span class="ansi-bright-black-fg">  Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg">  </span> ⋯

          σ²    0.8727    0.6249    0.0457   172.9255    74.6253    1.0142     ⋯
           x    0.0753    0.9823    0.0579   327.9569   337.9253    1.0062     ⋯
<span class="ansi-cyan-fg">                                                                1 column omitted</span>

Quantiles
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    2.5% </span> <span class="ansi-bold">   25.0% </span> <span class="ansi-bold">   50.0% </span> <span class="ansi-bold">   75.0% </span> <span class="ansi-bold">   97.5% </span>
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span>

          σ²    0.0735    0.3878    0.7253    1.2286    2.4196
           x   -1.8933   -0.3569   -0.0040    0.5913    2.1911
</pre>
</div>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="ansi-escaped-output">
<pre>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.93 seconds
Compute duration  = 2.93 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    mean </span> <span class="ansi-bold">     std </span> <span class="ansi-bold">    mcse </span> <span class="ansi-bold"> ess_bulk </span> <span class="ansi-bold"> ess_tail </span> <span class="ansi-bold">    rhat </span> <span class="ansi-bold"> e</span> ⋯
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg">  Float64 </span> <span class="ansi-bright-black-fg">  Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg">  </span> ⋯

          σ²    0.9825    0.6430    0.0659   137.4898    64.1419    1.0155     ⋯
           x   -0.1834    1.4025    0.1942   108.7116    32.0900    1.0146     ⋯
<span class="ansi-cyan-fg">                                                                1 column omitted</span>

Quantiles
 <span class="ansi-bold"> parameters </span> <span class="ansi-bold">    2.5% </span> <span class="ansi-bold">   25.0% </span> <span class="ansi-bold">   50.0% </span> <span class="ansi-bold">   75.0% </span> <span class="ansi-bold">   97.5% </span>
 <span class="ansi-bright-black-fg">     Symbol </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span> <span class="ansi-bright-black-fg"> Float64 </span>

          σ²    0.1654    0.4810    0.8381    1.3566    2.8325
           x   -4.2114   -0.5525   -0.0137    0.5049    2.1049
</pre>
</div>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../versions.html" class="pagination-link" aria-label="Versions">
        <span class="nav-page-text">Versions</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/TuringTutorials/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/TuringTutorials/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>